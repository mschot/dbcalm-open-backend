services:
  test-runner:
    build:
      context: .
      dockerfile: Dockerfile
    volumes:
      - ./artifacts:/tests/artifacts:ro
      - ./logs:/tests/logs:rw
      - ./test-results:/tests/test-results:rw
      - ../../:/app:ro  # Mount entire backend directory for test access
      - ./logs/dbcalm:/var/log/dbcalm:rw  # Expose DBCalm application logs
    environment:
      - PYTHONPATH=/app
      - E2E_TEST_MODE=true
      - API_BASE_URL=https://localhost:8335
    working_dir: /app/tests/e2e
    networks:
      - dbcalm-test

networks:
  dbcalm-test:
    driver: bridge
